<html>
    <body>
        <pe:mcml>
            <script type="text/npl" refresh="false" src="VipNotice.lua">
                local page = document:GetPageCtrl()
				local Config = NPL.load("(gl)Mod/WorldShare/config/Config.lua")
                local VipNotice = NPL.load("(gl)Mod/WorldShare/cellar/VipNotice/VipNotice.lua")
                local firstOpen = true;

                function close()
                    page:CloseWindow()
                end

                function get_window_style(w,h)
                    return Mod.WorldShare.Utils.FixCenter(w, h)
                end

                function open()
                    ParaGlobal.ShellExecute("open", Config.keepworkVipList[Config.defaultEnv], "", "", 1)
                    firstOpen = false;
                    page:Refresh(0);
                end

                function isFirstOpen()
                    return firstOpen;
                end

                function refreshVip()
                    VipNotice.RefreshVipInfo();
                    page:CloseWindow();
                end

                function isVip()
                    return Mod.WorldShare.Store:Get('user/isVip');
                end

				function onlyRecharge()
					return VipNotice.onlyRecharge;
				end

            </script>
            <div width="100%" height="100%">
                <pe:if condition='<%=onlyRecharge()%>'>
					<pe:if condition='<%=isVip()%>'>
							<pe:if condition='<%=isFirstOpen()%>'>
								<kp:window
									class="default"
									mode="lite"
									width="955"
									height="580"
									style="<%=get_window_style(955,580)%>"
									title='<%=L"续费Paracraft会员" %>'
									onclose="close">
										<div style="margin-left: 10px; margin-top: 40px; width: 932px; height: 534x; background: url(Texture/Aries/Creator/keepwork/vip/huiyuan_932X534_32bits.png#0 0 932 534)">
											<input type="button"  onclick="open" style="margin-left:55px;margin-top:380px;width: 184px;height: 124x;background: url(Texture/Aries/Creator/keepwork/vip/btn_zhaojiazhangkaitong_184X124_32bits.png#0 0 184 124)" />
											<div style="margin-left:120px;margin-top:-45px;color:#000000;"><%=L"立即续费" %></div>
										</div>
								</kp:window>
							</pe:if>
							<pe:if condition='<%=not isFirstOpen()%>'>
								<kp:window
									class="default"
									mode="lite"
									width="400"
									height="200"
									style="<%=get_window_style(400,200)%>"
									title='<%=L"开通Paracraft会员" %>'
									onclose="close">
										<div style="padding: 30px;">
											<div style="font-size: 14px;margin-left: 0px;margin-top: 20px;color:#000000;">
												<%= L"请您在新打开的窗口中进行支付，支付完成前请不要关闭本窗口" %>
											</div>
											<div style="margin-left: 85px;margin-top:30px;">
												<input type="button" style="width: 150px;height: 30px;" class="mc_light_grey_button_with_fillet" onclick="refreshVip" value='<%= L"已完成支付" %>' />
											</div>
										</div>
								</kp:window>
							</pe:if>
					</pe:if>
					<pe:if condition='<%=not isVip()%>'>
							<pe:if condition='<%=isFirstOpen()%>'>
								<kp:window
									class="default"
									mode="lite"
									width="955"
									height="580"
									style="<%=get_window_style(955,580)%>"
									title='<%=L"开通Paracraft会员" %>'
									onclose="close">
										<div style="margin-left: 10px; margin-top: 40px; width: 932px; height: 534x; background: url(Texture/Aries/Creator/keepwork/vip/huiyuan_932X534_32bits.png#0 0 932 534)">
											<input type="button"  onclick="open" style="margin-left:55px;margin-top:380px;width: 184px;height: 124x;background: url(Texture/Aries/Creator/keepwork/vip/btn_zhaojiazhangkaitong_184X124_32bits.png#0 0 184 124)" />
											<div style="margin-left:110px;margin-top:-45px;color:#000000;"><%=L"找家长续费" %></div>
										</div>
								</kp:window>
							</pe:if>
							<pe:if condition='<%=not isFirstOpen()%>'>
								<kp:window
									class="default"
									mode="lite"
									width="400"
									height="200"
									style="<%=get_window_style(400,200)%>"
									title='<%=L"开通Paracraft会员" %>'
									onclose="close">
										<div style="padding: 30px;">
											<div style="font-size: 14px;margin-left: 0px;margin-top: 20px;color:#000000;">
												<%= L"请您在新打开的窗口中进行支付，支付完成前请不要关闭本窗口" %>
											</div>
											<div style="margin-left: 85px;margin-top:30px;">
												<input type="button" style="width: 150px;height: 30px;" class="mc_light_grey_button_with_fillet" onclick="refreshVip" value='<%= L"已完成支付" %>' />
											</div>
										</div>
								</kp:window>
							</pe:if>
					</pe:if>
				</pe:if>
                <pe:if condition='<%=not onlyRecharge()%>'>
					<pe:if condition='<%=isFirstOpen()%>'>
								<kp:window
									class="default"
									mode="lite"
									width="955"
									height="580"
									style="<%=get_window_style(955,580)%>"
									title='<%=L"Paracraft会员权限提示" %>'
									onclose="close">
										<div style="margin-left: 10px; margin-top: 40px; width: 932px; height: 534x; background: url(Texture/Aries/Creator/keepwork/vip/huiyuan_932X534_32bits.png#0 0 932 534)">
											<input type="button"  onclick="open" style="margin-left:55px;margin-top:380px;width: 184px;height: 124x;background: url(Texture/Aries/Creator/keepwork/vip/btn_zhaojiazhangkaitong_184X124_32bits.png#0 0 184 124)" />
											<div style="margin-left:110px;margin-top:-45px;color:#000000;"><%=L"找家长续费" %></div>
										</div>
								</kp:window>
							</pe:if>
							<pe:if condition='<%=not isFirstOpen()%>'>
								<kp:window
									class="default"
									mode="lite"
									width="400"
									height="200"
									style="<%=get_window_style(400,200)%>"
									title='<%=L"开通Paracraft会员" %>'
									onclose="close">
										<div style="padding: 30px;">
											<div style="font-size: 14px;margin-left: 0px;margin-top: 20px;color:#000000;">
												<%= L"请您在新打开的窗口中进行支付，支付完成前请不要关闭本窗口" %>
											</div>
											<div style="margin-left: 85px;margin-top:30px;">
												<input type="button" style="width: 150px;height: 30px;" class="mc_light_grey_button_with_fillet" onclick="refreshVip" value='<%= L"已完成支付" %>' />
											</div>
										</div>
								</kp:window>
							</pe:if>
                </pe:if>
            </div>
        </pe:mcml>
    </body>
</html>
